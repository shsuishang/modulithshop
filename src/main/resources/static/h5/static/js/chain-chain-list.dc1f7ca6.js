(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chain-chain-list"],{8309:function(t,i,a){var e=a("91ae");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var n=a("967d").default;n("5a91bb7a",e,!0,{sourceMap:!1,shadowMode:!1})},"91ae":function(t,i,a){var e=a("c86c");i=e(!1),i.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */[data-v-789799dc]:export{theme_bg:#e93323}.list-box[data-v-789799dc]{background-color:#fff;color:#333}.item-box[data-v-789799dc]{padding:%?20?%;border-bottom:%?1?% solid #eee}.flex-box[data-v-789799dc]{display:flex;align-items:center;position:relative}.flex-shop[data-v-789799dc]{width:%?34?%;height:%?34?%}.flex-title[data-v-789799dc]{font-size:%?30?%;margin-left:%?10?%;max-width:75%;overflow:hidden;height:%?40?%;line-height:%?40?%;text-overflow:ellipsis;white-space:nowrap}.flex-postion[data-v-789799dc]{display:flex;align-items:center;position:absolute;right:0}.flex-postion uni-image[data-v-789799dc]{width:%?20?%;height:%?26?%}.flex-postion uni-label[data-v-789799dc]{font-size:%?24?%;color:#9b9b9b;margin-left:%?10?%}.m-nearbylist[data-v-789799dc]{position:absolute;width:100%;height:100%}.flex-info[data-v-789799dc]{display:flex;flex-direction:column;justify-content:center}.flex-info uni-view[data-v-789799dc]{margin:%?10?% 0 0 0;font-size:%?28?%}.flex-info-box[data-v-789799dc]{display:flex;align-items:flex-start}.flex-info uni-label[data-v-789799dc]{display:inline-block;vertical-align:top;word-wrap:break-word;width:%?520?%}.flex-info uni-image[data-v-789799dc]{width:%?40?%;height:%?40?%;position:absolute;right:%?10?%}.flex-info-title[data-v-789799dc]{flex-basis:%?145?%}.open_ba[data-v-789799dc]{width:80%;margin:0 auto}.open_dl[data-v-789799dc]{width:34%;height:%?79?%;background:#3c6;border-radius:%?20?%;text-align:center;color:#fff;margin:%?79?% auto 0 auto;line-height:%?75?%}.nearbylist-item[data-v-789799dc]{padding:%?20?% %?30?%;border-bottom:1px solid #eee;background:#fff}.nearbylist-item[data-v-789799dc]:last-child{border:none}.item-info[data-v-789799dc]{position:relative;font-size:%?28?%}.item-name[data-v-789799dc]{display:inline-block;font-size:%?30?%}.item-phone[data-v-789799dc]{line-height:%?45?%;display:flex;align-items:center}.item-distance[data-v-789799dc]{float:right;font-size:%?26?%;color:#bbb}.item-address[data-v-789799dc]{position:relative;font-size:%?26?%;color:#bbb;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;margin-right:%?40?%;line-height:%?40?%}.item-info[data-v-789799dc]::after{content:" ";display:inline-block;height:%?12?%;width:%?12?%;border-width:%?4?% %?4?% 0 0;border-color:#ebebe7;border-style:solid;-webkit-transform:matrix(.71,.71,-.71,.71,0,0);transform:matrix(.71,.71,-.71,.71,0,0);top:%?-4?%;position:absolute;top:72%;right:%?4?%;padding:%?3?%}.m-nearbylist[data-v-789799dc]{height:100%;position:absolute}',""]),t.exports=i},aae4:function(t,i,a){"use strict";a.d(i,"b",(function(){return e})),a.d(i,"c",(function(){return n})),a.d(i,"a",(function(){}));var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("v-uni-view",{staticClass:"page"},[t.loadComplete?a("v-uni-view",[t.isdata&&!t.issshow?[a("v-uni-scroll-view",{staticClass:"m-nearbylist",attrs:{"scroll-y":"true"},on:{scrolltolower:function(i){arguments[0]=i=t.$handleEvent(i),t.scrollbottom.apply(void 0,arguments)}}},[t._l(t.Info,(function(i,e){return a("v-uni-view",{key:e,staticClass:"list-box",attrs:{"data-chain_id":i.chain_id,"data-chain_name":i.chain_name},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.gopage.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"item-box"},[a("v-uni-view",{staticClass:"flex-box"},[a("v-uni-image",{staticClass:"flex-shop",attrs:{src:i.chain_img}}),a("v-uni-label",{staticClass:"flex-title"},[t._v(t._s(i.chain_name))]),a("v-uni-view",{staticClass:"flex-postion"},[a("v-uni-image",{attrs:{src:"https://static.shopsuite.cn/xcxfile/appicon/img/location.png"}}),a("v-uni-label",[t._v(t._s(i.distance))])],1)],1),a("v-uni-view",{staticClass:"flex-info"},[a("v-uni-view",{staticClass:"flex-info-box",attrs:{"data-phone":i.chain_mobile},on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.call.apply(void 0,arguments)}}},[a("v-uni-label",{staticClass:"flex-info-title"},[t._v(t._s(t.__("商家电话：")))]),a("v-uni-label",{staticStyle:{color:"#0095fd"}},[t._v(t._s(i.chain_mobile))])],1),a("v-uni-view",{staticClass:"flex-info-box",attrs:{"data-chain_id":i.chain_id,"data-chain_name":i.chain_name,"data-address":i.chain_district_info,"data-name":i.chain_name,"data-lat":i.chain_lat,"data-lng":i.chain_lng},on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.gotomap.apply(void 0,arguments)}}},[a("v-uni-label",{staticClass:"flex-info-title"},[t._v(t._s(t.__("商家地址：")))]),a("v-uni-label",[t._v(t._s(i.chain_district_info))])],1),a("v-uni-image",{attrs:{src:"https://static.shopsuite.cn/xcxfile/appicon/img/right.png"}})],1)],1)],1)})),a("v-uni-view",{staticClass:"m-loading-box"},[t.ispage&&!t.issshow?[a("v-uni-view",{staticClass:"u-loadmore"},[a("v-uni-label",{staticClass:"u-loading"}),a("v-uni-text",{staticClass:"u-loadmore-tips"},[t._v(t._s(t.__("正在加载")))])],1)]:t._e(),t.ispage||t.issshow?t._e():[a("v-uni-view",{staticClass:"u-loadmore u-loadmore-line"},[a("v-uni-text",{staticClass:"u-loadmore-tips"},[t._v(t._s(t.__("没有更多数据啦！")))])],1)]],2)],2)]:t._e(),t.isdata?t._e():a("v-uni-view",{staticClass:"m-nullcontent"},[a("v-uni-view",{staticClass:"m-nullpage-middle"},[a("v-uni-label",{staticClass:"iconfont icon-meiyougengduo"}),a("v-uni-view",{staticClass:"m-null-tip"},[a("v-uni-text",[t._v(t._s(t.__("亲~什么都没有")))]),a("v-uni-text",[t._v(t._s(t.__("附近没什么门店!")))])],1)],1)],1)],2):t._e(),t.isdata&&t.issshow?a("v-uni-view",{staticClass:"open_ba"},[a("v-uni-view",{staticStyle:{width:"200rpx","/*height":"100px*/margin: 71px auto 25px auto",wxcs_style_margin:"143rpx auto 50rpx auto",auto:"50rpx auto"}},[a("v-uni-image",{staticStyle:{width:"200rpx",height:"200rpx","/*margin":"0 auto"},attrs:{src:"https://static.shopsuite.cn/xcxfile/appicon/img/ditulogo.png"}})],1),a("v-uni-view",{staticStyle:{"font-size":"28rpx"}},[t._v(t._s(t.__("无法获取到您的定位，请开启地理位置权限，将根据你的位置展示附近门店。")))]),a("v-uni-button",{staticStyle:{width:"34%",height:"79rpx",background:"#33cc66",margin:"39px auto 0 auto",wxcs_style_margin:"79rpx auto 0 auto",color:"#fff","line-height":"80rpx","text-align":"center"},attrs:{"open-type":"openSetting"},on:{opensetting:function(i){arguments[0]=i=t.$handleEvent(i),t.handler.apply(void 0,arguments)}}},[t._v(t._s(t.__("去开启")))])],1):t._e()],1)},n=[]},aed0:function(t,i,a){"use strict";var e=a("8309"),n=a.n(e);n.a},c471:function(t,i,a){"use strict";a.r(i);var e=a("aae4"),n=a("ce0d");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(i,t,(function(){return n[t]}))}(o);a("aed0");var s=a("828b"),l=Object(s["a"])(n["default"],e["b"],e["c"],!1,null,"789799dc",null,!1,e["a"],void 0);i["default"]=l.exports},ce0d:function(t,i,a){"use strict";a.r(i);var e=a("dae7"),n=a.n(e);for(var o in e)["default"].indexOf(o)<0&&function(t){a.d(i,t,(function(){return e[t]}))}(o);i["default"]=n.a},dae7:function(t,i,a){"use strict";a("6a54");var e=a("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,a("c223"),a("e838"),a("e966");var n=e(a("9b1b")),o=a("8f59"),s={data:function(){return{options:{},page:1,ispage:!0,flag:!0,Info:[],latitude:-.006004173607198179,longitude:-.006504558314413798,isdata:!1,issshow:0,item_id:0,store_id:null,chain_id:null,rows:10,loadComplete:!1}},computed:(0,o.mapState)(["Config","StateCode","notice","plantformInfo","shopInfo","userInfo","hasLogin"]),onLoad:function(t){uni.setNavigationBarTitle({title:this.__("附近门店")});var i=this;i.setData({options:t,store_id:t.store_id?t.store_id:"",item_id:t.item_id?t.item_id:""}),i.$.getLocation({type:"wgs84",success:function(t){i.setData({latitude:t.latitude,longitude:t.longitude}),i.getNearbylist()},fail:function(){i.setData({isdata:!0,latitude:-.006004173607198179,longitude:-.006504558314413798}),i.$.confirm(i.__("手机定位失败！")),i.getNearbylist()}})},methods:(0,n.default)((0,n.default)({},(0,o.mapMutations)(["login","logout","getPlantformInfo","forceUserInfo","getUserInfo"])),{},{getNearbylist:function(){var t=this,i={lat:t.latitude,lng:t.longitude,page:t.page,rows:t.rows,store_id:t.options.store_id?t.options.store_id:"",item_id:t.options.item_id?t.options.item_id:""};t.$.request({url:this.Config.URL.chain.getNearChain,data:i,dataType:"json",success:function(i,a,e,n){if(200==a){for(var o=0;o<i.items.length;o++){var s=t.$.bMapTransQQMap(i.items[o]["chain_lng"],i.items[o]["chain_lat"]);i.items[o]["chain_lng"]=s.lng,i.items[o]["chain_lat"]=s.lat,console.info(s);var l=t.getDistance(t.latitude,t.longitude,s.lat,s.lng);i.items[o]["distance"]=t.$.distanceFormat(l)}t.setData({isdata:!0,loadComplete:!0}),i.page>=i.total?t.setData({flag:!1,ispage:!1,Info:t.Info.concat(i.items)}):t.setData({flag:!0,ispage:!0,Info:t.Info.concat(i.items)})}else t.setData({flag:!1,ispage:!1,loadComplete:!0})},fail:function(i){t.setData({loadComplete:!0}),t.$.alert("网络异常请重试！")}})},gotomap:function(t){this.options.issub?this.backCheckout(t.currentTarget.dataset):this.$.openLocation({latitude:parseFloat(t.currentTarget.dataset.lat),longitude:parseFloat(t.currentTarget.dataset.lng),name:t.currentTarget.dataset.name,address:t.currentTarget.dataset.address,scale:28})},gopage:function(t){this.options.issub?this.backCheckout(t.currentTarget.dataset):this.options.is_flag?this.setChain(t.currentTarget.dataset):this.$.gotopage("/chain/chain/index?chain_id="+t.currentTarget.dataset.chain_id)},backCheckout:function(t){var i=this,a=this.options;a.chain_id=t.chain_id;for(var e={},n=this.Info,o=0;o<n.length;o++)n[o].chain_id==t.chain_id&&(e=n[o]);a.ChainInfo=e,i.$.navigateBack(1,(function(){i.notice.postNotificationName("RefreshOrderChain",a)}))},scrollbottom:function(){if(this.flag){var t=this;t.setData({flag:!1}),clearTimeout(i);var i=setTimeout((function(){t.setData({type:t.type,page:parseInt(t.page)+1,rows:10}),t.getNearbylist()}),500)}},setChain:function(t){var i=this;i.$.showModal({title:"提示",content:"确定该门店成为您的默认自提点吗？",success:function(a){if(a.confirm){uni.setStorageSync("chain_id",t.chain_id),uni.setStorageSync("chain_name",t.chain_name);var e={chain_id:t.chain_id};i.$.request({url:i.Config.URL.setChain,data:e,dataType:"json",success:function(t,a,e,n){200==a?i.$.gopage("/pages/index/index"):i.$.alert("设置失败，请重新选择")}})}}})},selectchain:function(t){for(var i={},a=this.Info,e=0;e<a.length;e++)a[e].chain_id==t.currentTarget.dataset.chain_id&&(i=a[e]);var n=this;n.$.navigateBack(1,(function(){var t={chain_id:n.chain_id,spinfo:n.spid,ChainInfo:i};n.notice.postNotificationName("RefreshOrderChain",t)}))},selectAddress:function(t){for(var i={},a=this.Info,e=0;e<a.length;e++)a[e].chain_id==t.currentTarget.dataset.chain_id&&(i=a[e]);var n=this;n.$.navigateBack(1,(function(){var t={chain_id:n.chain_id,spinfo:n.spid,ChainInfo:i};n.notice.postNotificationName("RefreshOrderChain",t)}))},call:function(t){this.$.makePhoneCall({phoneNumber:t.currentTarget.dataset.phone})},getDistance:function(t,i,a,e){var n=t*Math.PI/180,o=a*Math.PI/180,s=n-o,l=i*Math.PI/180-e*Math.PI/180,c=2*Math.asin(Math.sqrt(Math.pow(Math.sin(s/2),2)+Math.cos(n)*Math.cos(o)*Math.pow(Math.sin(l/2),2)));return c*=6378.137,c=Math.round(1e4*c)/10,c}})};i.default=s}}]);